!function(window,document){function setup(){var location=window.location,isMobile=window.matchMedia("(max-device-width: 700px)").matches;function createDiv(t){var e=document.createElement("div");if(t)for(var i in t)e.style[i]=t[i];return document.body.appendChild(e),e}var styleElem=document.head.appendChild(document.createElement("style"));styleElem.innerHTML='.iticks-pop-button{position:fixed;z-index:2147483648;border:0;box-shadow: 0 0px 20px 0 rgba(0, 0, 0, .25);;transition:all .4s, bottom .8s ease-in-out;cursor:pointer;animation-duration:.2s;width:64px;height:64px;border-radius:32px;top:auto !important;}.iticks-badge-container{background: #ea4141;position: absolute;top: -3px;height: 17px;width: 17px;border-radius: 100px;box-shadow: 0 1px 5px 0 rgba(0, 0, 0, .5);}.iticks-badge-num{font-size:11px;line-height:17px;color:#fff;text-align: center;font-weight: bold;}.agent-img{width:64px !important;height:64px !important;margin:0px !important;border-radius:50%;}.iticks-close-btn{visibility:hidden;text-align:right;height:30px;}.iticks-close-btn span{cursor:pointer;padding: 0px 5px;display:inline-block;}.iticks-close-btn img{width:16px;height:16px;display:inline;}.iticks-notif-msg:hover .iticks-close-btn{visibility:visible;}.iticks-notif-msg {position: fixed;max-width: 250px;z-index:2147483648;transition:all .4s, bottom .8s ease-in-out;animation-duration:.2s;}.iticks-last-msg{white-space:pre-wrap;max-width:250px;padding: 10px 15px;box-shadow: 0 0 25px 7px rgba(0,0,0,.35);background: #fff;border: 0px solid;border-radius: 3px;}.notif-msg > div {max-height: 51px;line-height: 17px;overflow: hidden;word-break: break-all;}.notif-msg > div::before {content: "...";position: absolute;right: 6px;bottom: 9px;}.notif-msg > div::after {content:"";position: absolute;right: 4px;width: 1em;height: 1em;margin-top: 0.2em;background: #FFF;}.notif-msg-tri {position: fixed;width: 36px;height:26px;border-bottom: 0px solid;z-index:2147483648;transition:all .4s, bottom .8s ease-in-out;animation-duration:.2s;}.iticks-last-container{z-index:2147483648;color:#000;}.iticks-last-container p{margin:0;}.iticks-badge-container{display:none;}.iticks-frame-container{height:100%;transition: all .4s,bottom .8s ease-in-out !important;top:auto !important;}.iticks-hidden{top:auto !important;bottom:-100% !important}@media only screen and (max-device-width:700px) {body.iticks-open{overflow:auto;width:100%;height:100%;position:fixed;}.iticks-close-btn{visibility:visible;}.iticks-frame-container{width:100% !important;height:100% !important;max-height:unset !important;right:0 !important;left: 0 !important}}';var buttonDiv=createDiv({});buttonDiv.innerHTML='<div class="iticks-pop-button"><img class="chat-icon" style="width:32px;height:32px;margin:16px;" src="'+window.iticks.cdn+'/assets/chat_icon.png"/><div class="iticks-badge-container"><div class="iticks-badge-num">0</div></div></div><div class="iticks-last-container"><div class="iticks-notif-msg iticks-hidden"><div class="iticks-close-btn"><span><img src="'+window.iticks.cdn+'/assets/chatwindow/close.png"/></span></div><div class="iticks-last-msg"></div></div><div class="notif-msg-tri iticks-hidden"><img style="height:26px !important;display:block;margin:0px !important" src="'+window.iticks.cdn+'/assets/small_curved.png"></div></div>';var containerDiv=createDiv({position:"fixed",display:"block",background:"transparent","z-index":"2147483649","box-shadow":"0 0 15px 0 rgba(0, 0, 0, .15)"});containerDiv.className="iticks-frame-container",containerDiv.innerHTML='<iframe src="'+window.iticks.host+"/widgets/engage/"+window.iticks.clientId+"?ref="+encodeURIComponent(document.referrer)+"&landing="+encodeURIComponent(window.location.href)+'&v=1" style="border:0;width:100%;height:100%;" allowfullscreen>Loading...</iframe>';var chatFrame=containerDiv.querySelector("iframe"),lastMsgContainer=buttonDiv.querySelector(".iticks-last-container"),lastMsgC1=lastMsgContainer.querySelector(".iticks-notif-msg"),lastMsgC2=lastMsgContainer.querySelector(".notif-msg-tri"),badgeContainer=buttonDiv.querySelector(".iticks-badge-container"),unreadCounter=buttonDiv.querySelector(".iticks-badge-num"),unreadMessage=buttonDiv.querySelector(".iticks-last-msg"),popbutton=buttonDiv.querySelector(".iticks-pop-button"),chatIcon=buttonDiv.querySelector(".chat-icon"),closeBtn=buttonDiv.querySelector(".iticks-close-btn>span"),lastState=null;function canLog(){return!!company&&-1!=["4wbQLsLgX95Kg6amw_c","pSZJr5kbAY7jEwEtf_c"].indexOf(company._id)}function maximizeChat(){"show.chatwidget"!=lastState&&(lastState="show.chatwidget",popbutton.classList.add("iticks-hidden"),lastMsgC1.classList.add("iticks-hidden"),lastMsgC2.classList.add("iticks-hidden"),containerDiv.classList.remove("iticks-hidden"),chatFrame.contentWindow.postMessage({type:"visibility",data:"WIDGET_MAXIMIZED"},"*"),document.body.classList.add("iticks-open"))}function minimizeChat(){"minimize.chat"!=lastState&&(lastState="minimize.chat",containerDiv.classList.add("iticks-hidden"),popbutton.classList.remove("iticks-hidden"),lastMsgC1.classList.add("iticks-hidden"),lastMsgC2.classList.add("iticks-hidden"),chatFrame.contentWindow.postMessage({type:"visibility",data:"WIDGET_MINIMIZED"},"*"),document.body.classList.remove("iticks-open"))}function hideWidget(){"hide.chatwidget"!=lastState&&(lastState="hide.chatwidget",containerDiv.classList.add("iticks-hidden"),popbutton.classList.add("iticks-hidden"),lastMsgC1.classList.add("iticks-hidden"),lastMsgC2.classList.add("iticks-hidden"),chatFrame.contentWindow.postMessage({type:"visibility",data:"WIDGET_HIDDEN"},"*"),document.body.classList.remove("iticks-open"))}buttonDiv.addEventListener("click",function(){maximizeChat()});var closeTime=localStorage.getItem("__iticks.closed"),isClosed=!1;closeTime&&Date.now()-parseInt(closeTime)<36e5&&(isClosed=!0),closeBtn.addEventListener("click",function(t){lastMsgC1.classList.add("iticks-hidden"),lastMsgC2.classList.add("iticks-hidden"),t.stopPropagation(),localStorage.setItem("__iticks.closed",Date.now()),isClosed=!0}),hideWidget();var isFrameReady=!1,isWidgetEnabled=!0;function getCookie(t){var e=("; "+document.cookie).split("; "+t+"=");if(2==e.length)return e.pop().split(";").shift()}var soundTimer=null,numBotSoundPlayed=0,company=null;function sendCRMIds(t){if(!(3<t)){var e=getCookie("hubspotutk"),i=!1;if(e&&(chatFrame.contentWindow.postMessage({type:"sethubtk",data:e},"*"),i=!0),window.MXCProspectId&&(chatFrame.contentWindow.postMessage({type:"setls",data:window.MXCProspectId},"*"),i=!0),company&&company.company_settings&&company.company_settings.crm_integration&&-1<company.company_settings.crm_integration.indexOf("GA")){var n=getCookie("_ga");if(n){var a=n.split(".");chatFrame.contentWindow.postMessage({type:"setga",data:a[2]+"."+a[3]},"*"),i=!0}}i||setTimeout(function(){sendCRMIds(t+1)},2e3)}}function receiveMessage(event){if(event.data&&event.data.type){if("activity"==event.data.type)window.dispatchEvent(new Event("_iticks.activity"));else if("theme.set"==event.data.type)popbutton.style.background=event.data.color;else if("minimize.chat"==event.data.type)minimizeChat();else if("show.chatwidget"==event.data.type)maximizeChat();else if("hide.chatwidget"==event.data.type)hideWidget();else if("reset.closebtn"==event.data.type)isClosed=!1;else if("frame.ready"==event.data.type){if(isFrameReady)return;if(isFrameReady=!0,sendCRMIds(0),onNewEvent(),window.iticks.call=function(t,e){if("minimize"==t)minimizeChat();else if("maximize"==t)maximizeChat();else if("hide"==t)hideWidget();else if("show"==t)switch(e){case"minimize":minimizeChat();break;case"maximize":maximizeChat();break;default:minimizeChat()}else chatFrame.contentWindow.postMessage({type:"function",data:{type:t,data:e}},"*")},0<window.iticks.queue.length)for(;0<window.iticks.queue.length;){var item=window.iticks.queue.shift();window.iticks.call(item[0],item[1])}}else if("disable.widget"==event.data.type)isWidgetEnabled=!1;else if("enable.widget"==event.data.type){if(isWidgetEnabled=!0,company=event.data.company,company&&company.company_settings&&company.company_settings.enable_payment){var h=document.head||document.documentElement,e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",h.insertBefore(e,h.firstChild)}company&&company.livechat_settings&&company.livechat_settings.color&&popbutton&&(popbutton.style.background=company.livechat_settings.color);var livechat_settings=event.data.livechat_settings,right=20,bottom=15,themecolor="#006ba7",font_family="",notif_line_height="",fsize=12,fweight=400,color="#000",wwidth=300,wheight=350,wx=10,wy=0,dirx="right";if(livechat_settings&&("undefined"!=typeof livechat_settings.widget_margin_x&&(right=livechat_settings.widget_margin_x),"undefined"!=typeof livechat_settings.widget_margin_y&&(bottom=livechat_settings.widget_margin_y),notif_line_height=livechat_settings.notif_line_height,themecolor=livechat_settings.color||themecolor,font_family=livechat_settings.notif_font_family,fsize=livechat_settings.notif_font_size||fsize,fweight=livechat_settings.notif_font_weight||fweight,color=livechat_settings.notif_font_color||color,wwidth=livechat_settings.widget_width||wwidth,wheight=livechat_settings.widget_height||wheight,"undefined"!=typeof livechat_settings.widget_x&&(wx=livechat_settings.widget_x),wy=livechat_settings.widget_y||wy,livechat_settings.chat_icon_img&&chatIcon&&(chatIcon.classList.add("agent-img"),chatIcon.src=window.iticks.cdn+"/assets/"+livechat_settings.chat_icon_img),livechat_settings.widget_position)){var posxy=livechat_settings.widget_position.split("_");-1<["left","right"].indexOf(posxy[1])&&(dirx=posxy[1])}var styleElem=document.head.appendChild(document.createElement("style"));styleElem.innerHTML=".iticks-pop-button{bottom:"+bottom+"px;"+dirx+":"+right+"px;background:"+themecolor+";}.iticks-badge-container{"+dirx+": -3px;}.iticks-notif-msg{"+dirx+":"+(69+right)+"px;bottom:"+bottom+"px;"+(font_family?"font-family: "+font_family+";":"")+(notif_line_height?"line-height:"+notif_line_height+"px;":"")+"font-size:"+fsize+"px;font-weight:"+fweight+";color:"+color+";}.notif-msg-tri{bottom:"+bottom+"px;"+dirx+":"+(35+right)+"px;"+("left"==dirx?"transform:scaleX(-1);":"")+"}.iticks-frame-container{width:"+wwidth+"px;max-height:"+wheight+"px;"+dirx+":"+wx+"px;bottom:"+wy+"px}@media only screen and (max-device-width: 700px) {.iticks-frame-container {bottom: 0px;left: 0px}}"}else if("notif"==event.data.type){if(canLog()&&console.log("received notif",event.data,soundTimer),soundTimer&&(clearTimeout(soundTimer),soundTimer=null),"show.chatwidget"==lastState||"hide.chatwidget"==lastState)return;if(0<event.data.count){var soundNumLimit=1;if(company&&company.livechat_settings&&!isNaN(company.livechat_settings.visitor_sound)&&(soundNumLimit=company.livechat_settings.visitor_sound),badgeContainer.style.display="block",unreadCounter.innerText=event.data.count+"",unreadMessage.innerHTML=event.data.message,isClosed&&event.data.lastIsBot)return;if(isMobile&&"Hide"==company.livechat_settings.mob_notif_msg&&event.data.lastIsBot)return;if(!isMobile&&"Hide"==company.livechat_settings.web_notif_msg&&event.data.lastIsBot)return;lastMsgC1.classList.remove("iticks-hidden"),lastMsgC2.classList.remove("iticks-hidden"),soundTimer=setTimeout(function(){if(!(event.data.lastIsBot&&soundNumLimit<=numBotSoundPlayed)){var t=new Audio(window.iticks.cdn+"/client/graceful.mp3");canLog()&&console.log("trying to play audio",event.data,numBotSoundPlayed);var e=t.play(),i=!1;e&&(e.then(function(){canLog()&&console.log("sound played"),event.data.lastIsBot&&!i&&(numBotSoundPlayed++,i=!0)})["catch"](function(t){canLog()&&console.log("sound not played",t)}),setTimeout(function(){event.data.lastIsBot&&!i&&(numBotSoundPlayed++,i=!0)},3e3))}},100)}else lastMsgC1.classList.add("iticks-hidden"),lastMsgC2.classList.add("iticks-hidden"),badgeContainer.style.display="none"}else if("initData"==event.data.type)chatFrame.contentWindow.postMessage({type:"setInitData",data:window.iticks.initData},"*");else if("config.paymentOptions"==event.data.type){var iticksFrame=$(".iticks-frame-container");iticksFrame.css("z-index","999999999"),event.data.options.handler=function(t){chatFrame.contentWindow.postMessage({type:"paymentAuthorized",data:t.razorpay_payment_id,msgId:event.data.msgId},"*"),iticksFrame.css("z-index","2147483648")},event.data.options.modal={ondismiss:function(t){chatFrame.contentWindow.postMessage({type:"paymentDismiss",msgId:event.data.msgId},"*"),iticksFrame.css("z-index","2147483648")}},window.rzp=new Razorpay(event.data.options)}else if("show.paymentForm"==event.data.type)window.rzp&&window.rzp.open(),chatFrame.contentWindow.postMessage({type:"paymentInitiate",msgId:event.data.msgId},"*");else if("hide.paymentForm"==event.data.type)window.rzp&&window.rzp.close();else if("set.chatIcon"==event.data.type)chatIcon.src=event.data.chatIcon,chatIcon.classList.add("agent-img"),popbutton.style.background="transparent";else if("execute.javaScript"==event.data.type&&event.data.code)try{eval(event.data.code)}catch(error){console.log("Error: ",error)}}else;}var pendingEvents=[];function onNewEvent(){0<pendingEvents.length&&isFrameReady&&chatFrame.contentWindow.postMessage({type:"history",data:pendingEvents.splice(0)},"*")}function recordEvent(t){isWidgetEnabled&&(pendingEvents.push(t),onNewEvent())}recordEvent({type:"Click",url:location.href,time:Date.now()});var isVisible=("undefined"!=typeof document.hidden?(x="hidden",y="visibilitychange"):"undefined"!=typeof document.msHidden?(x="msHidden",y="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(x="webkitHidden",y="webkitvisibilitychange"),"undefined"==typeof document.addEventListener||"undefined"==typeof document[x]?console.log("IntelliTicks requires a browser, such as Google Chrome or Firefox, that supports the Page Visibility API."):(document.addEventListener(y,A,!1),window.addEventListener("hashchange",A,!1)),document[x]?(z=!1,recordEvent({type:"Hide",url:location.href,time:Date.now()+1})):(z=!0,recordEvent({type:"Show",url:location.href,time:Date.now()+1})),D(),window.addEventListener("mousemove",D,!1),window.addEventListener("mousedown",D,!1),window.addEventListener("keypress",D,!1),window.addEventListener("DOMMouseScroll",D,!1),window.addEventListener("mousewheel",D,!1),window.addEventListener("touchmove",D,!1),window.addEventListener("MSPointerMove",D,!1),window.addEventListener("_iticks.activity",D,!1),function(){return z}),x,y,z,B;function A(){(z=!document[x])&&D(),recordEvent({type:z?"Show":"Hide",time:Date.now(),url:location.href})}function D(){z||recordEvent({type:"Show",url:location.href,time:Date.now()}),z=!0,function t(){B&&window.clearTimeout(B),B=window.setTimeout(function(){z=!1,recordEvent({type:"Hide",url:location.href,time:Date.now()+1})},3e4)}()}!function(s){function t(o){return function(t,e,i){var n=c[o].apply(s,arguments),a=Date.now();return isVisible()||recordEvent({type:"Hide",url:d,time:a}),recordEvent({type:"Click",url:location.href,time:a+1}),isVisible()||recordEvent({type:"Show",url:location.href,time:a+2}),d=location.href,n}}var d=location.href,c={pushState:s.pushState,replaceState:s.replaceState};for(field in c)s[field]=t(field)}(window.history),window.addEventListener("message",receiveMessage,!1)}"interactive"==document.readyState||"complete"==document.readyState?setup():document.addEventListener?document.addEventListener("readystatechange",function(){"interactive"==document.readyState&&setup()}):document.attachEvent&&document.attachEvent("readystatechange",function(){"interactive"==document.readyState&&setup()})}(window,document);
